{% extends 'base.html' %}

{% block title %}–ú–æ–∏ –ø—Ä–∏–≤—ã—á–∫–∏ - –¢—Ä–µ–∫–µ—Ä –ø—Ä–∏–≤—ã—á–µ–∫{% endblock %}

{% block extra_css %}
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}
body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
    color: #f1f5f9;
    min-height: 100vh;
    padding: 60px 20px 40px;
    position: relative;
    overflow-x: hidden;
}
.container {
    max-width: 1000px;
    margin: 0 auto;
    position: relative;
    z-index: 2;
}
.page-header {
    text-align: center;
    margin-bottom: 50px;
    position: relative;
}
.page-header::after {
    content: '';
    position: absolute;
    bottom: -25px;
    left: 50%;
    transform: translateX(-50%);
    width: 120px;
    height: 4px;
    background: linear-gradient(90deg, #38bdf8, #0ea5e9);
    border-radius: 2px;
}
.page-title {
    font-size: 42px;
    font-weight: 700;
    margin-bottom: 16px;
    background: linear-gradient(90deg, #f1f5f9, #cbd5e1);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: -0.5px;
}
.page-subtitle {
    font-size: 19px;
    color: #94a3b8;
    font-weight: 500;
    max-width: 600px;
    margin: 0 auto;
    line-height: 1.6;
}
.habits-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 28px;
    align-items: stretch;
}
.habit-card {
    background: rgba(15, 23, 42, 0.7);
    backdrop-filter: blur(12px);
    border-radius: 20px;
    padding: 28px;
    border: 1px solid rgba(56, 189, 248, 0.2);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    display: flex;
    flex-direction: column;
    min-height: 420px; /* –ï–¥–∏–Ω–∞—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ */
}
.habit-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
}
.habit-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 20px;
    min-height: 60px;
}
.habit-title {
    font-size: 22px;
    font-weight: 700;
    color: #f1f5f9;
    margin-bottom: 8px;
    line-height: 1.3;
    /* –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π line-clamp */
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    word-break: break-word;
}
.habit-type {
    font-size: 14px;
    padding: 4px 10px;
    border-radius: 12px;
    font-weight: 600;
    white-space: nowrap;
    margin-left: 10px;
}
.type-good {
    background: rgba(34, 197, 94, 0.15);
    color: #6ee7b7;
}
.type-bad {
    background: rgba(239, 68, 68, 0.15);
    color: #fca5a5;
}
.habit-description {
    color: #cbd5e1;
    font-size: 16px;
    line-height: 1.6;
    margin-bottom: 22px;
    word-wrap: break-word;
    overflow-wrap: break-word;
    flex: 1;
    min-height: 80px;
    max-height: 120px;
    overflow-y: auto;
    padding-right: 8px;
    /* –°–∫—Ä–æ–ª–ª–±–∞—Ä —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ */
}
/* –°–∫—Ä–æ–ª–ª–±–∞—Ä */
.habit-description::-webkit-scrollbar {
    width: 6px;
}
.habit-description::-webkit-scrollbar-track {
    background: transparent;
}
.habit-description::-webkit-scrollbar-thumb {
    background: rgba(56, 189, 248, 0.4);
    border-radius: 3px;
}
.habit-description::-webkit-scrollbar-thumb:hover {
    background: rgba(56, 189, 248, 0.6);
}
.habit-details {
    display: flex;
    flex-direction: column;
    gap: 14px;
    margin-bottom: 24px;
    flex-shrink: 0; /* –ù–µ —Å–∂–∏–º–∞–µ—Ç—Å—è */
}
.detail-item {
    display: flex;
    align-items: flex-start; /* –í–∞–∂–Ω–æ –¥–ª—è –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö –¥–Ω–µ–π */
    gap: 12px;
    font-size: 15px;
    color: #94a3b8;
}
.detail-icon {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(56, 189, 248, 0.1);
    border-radius: 6px;
    color: #38bdf8;
    flex-shrink: 0;
}
.days-container {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 6px;
}
.day-badge {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(56, 189, 248, 0.1);
    border-radius: 8px;
    font-size: 13px;
    font-weight: 600;
    color: #94a3b8;
}
.day-badge.active {
    background: rgba(56, 189, 248, 0.25);
    color: #38bdf8;
}
.habit-actions {
    display: flex;
    gap: 12px;
    margin-top: auto;
    min-height: 50px;
}
.action-btn {
    flex: 1;
    padding: 10px;
    border-radius: 12px;
    font-weight: 600;
    font-size: 15px;
    cursor: pointer;
    transition: all 0.2s ease;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    color: white;
}
.edit-btn {
    background: rgba(56, 189, 248, 0.15);
    color: #38bdf8;
}
.edit-btn:hover {
    background: rgba(56, 189, 248, 0.25);
}
.delete-btn {
    background: rgba(239, 68, 68, 0.15);
    color: #fca5a5;
}
.delete-btn:hover {
    background: rgba(239, 68, 68, 0.25);
}

/* –ú–û–ë–ò–õ–¨–ù–´–ï –£–°–¢–†–û–ô–°–¢–í–ê */
@media (max-width: 768px) {
    .habits-grid {
        grid-template-columns: 1fr;
    }
    .page-title {
        font-size: 32px;
    }
    .page-subtitle {
        font-size: 17px;
    }
    .habit-card {
        min-height: 380px;
    }
}
@media (max-width: 480px) {
    .habit-actions {
        flex-direction: column;
    }
    .page-title {
        font-size: 28px;
    }
    .habit-header {
        flex-direction: column;
        align-items: flex-start;
    }
    .habit-type {
        margin-left: 0;
        margin-top: 5px;
    }
    .habit-card {
        min-height: 400px;
    }
    .detail-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
    }
    .days-container {
        margin-top: 4px;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1 class="page-title">–ú–æ–∏ –ø—Ä–∏–≤—ã—á–∫–∏</h1>
        <p class="page-subtitle">–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å–≤–æ–∏ –ø—Ä–∏–≤—ã—á–∫–∏ –∏ –æ—Ç–º–µ—á–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å</p>
    </div>
    
    <div class="habits-grid">
        {% for habit in habits %}
        <div class="habit-card">
            <div class="habit-header">
                <div style="flex: 1;">
                    <h3 class="habit-title">{{ habit.title}}</h3>
                    <span class="habit-type {% if habit.habit_type == 'useful' %}type-good{% else %}type-bad{% endif %}">
                        {{ habit.get_habit_type_display }}
                    </span>
                </div>
            </div>
            <p class="habit-description">{{ habit.description }}</p>
            
            <div class="habit-details">
                <div class="detail-item">
                    <!-- <div class="detail-icon">‚è∞</div> -->
                    <span>–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {{ habit.reminder_time|time:"H:i" }}</span>
                </div>
                <div class="detail-item">
                    <!-- <div class="detail-icon">‚è±Ô∏è</div> -->
                    <span>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {{ habit.duration_display }}</span>
                </div>
                <div class="detail-item">
                    <!-- <div class="detail-icon">üìÖ</div> -->
                    <div>
                        <span>–î–Ω–∏ –Ω–µ–¥–µ–ª–∏:</span>
                        <div class="days-container">
                            <span class="day-badge {% if 'mon' in habit.days_of_week %}active{% endif %}">–ü–Ω</span>
                            <span class="day-badge {% if 'tue' in habit.days_of_week %}active{% endif %}">–í—Ç</span>
                            <span class="day-badge {% if 'wed' in habit.days_of_week %}active{% endif %}">–°—Ä</span>
                            <span class="day-badge {% if 'thu' in habit.days_of_week %}active{% endif %}">–ß—Ç</span>
                            <span class="day-badge {% if 'fri' in habit.days_of_week %}active{% endif %}">–ü—Ç</span>
                            <span class="day-badge {% if 'sat' in habit.days_of_week %}active{% endif %}">–°–±</span>
                            <span class="day-badge {% if 'sun' in habit.days_of_week %}active{% endif %}">–í—Å</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="habit-actions">
                <button class="action-btn edit-btn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                <button class="action-btn delete-btn">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}